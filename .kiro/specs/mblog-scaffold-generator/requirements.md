# 需求文档

## 简介

mblog 是一个用 Python 编写的博客脚手架生成工具。它能够通过简单的命令行操作创建一个完整的静态博客项目，包括 Markdown 文章管理、主题系统、静态页面生成以及 GitHub 自动部署配置。该工具旨在为开发者提供一个快速启动博客的解决方案，同时支持社区开发者扩展和自定义主题。

## 需求

### 需求 1：项目初始化

**用户故事：** 作为博客作者，我希望通过一个简单的命令创建新的博客项目，以便快速开始写作而不需要手动配置复杂的项目结构。

#### 验收标准

1. WHEN 用户执行 `mblog new <project_name>` 命令 THEN 系统应当在当前目录下创建一个名为 `<project_name>` 的新目录
2. WHEN 项目创建成功 THEN 系统应当生成以下目录结构：
   - `.workflow/` 目录用于 GitHub Actions 自动部署配置
   - `md/` 目录用于存储 Markdown 博客文章
   - `theme/` 目录用于存储页面样式相关文件
   - `gen.py` 文件作为静态页面生成程序
   - `config.json` 文件作为博客配置文件
3. WHEN 项目创建完成 THEN 系统应当在命令行输出成功消息，提示用户下一步操作
4. IF 目标目录已存在 THEN 系统应当提示错误信息并终止操作，避免覆盖现有内容

### 需求 2：Markdown 文章管理

**用户故事：** 作为博客作者，我希望能够在 `md/` 目录中管理我的 Markdown 文章，以便使用熟悉的格式进行写作。

#### 验收标准

1. WHEN 用户在 `md/` 目录中创建或修改 `.md` 文件 THEN 系统应当能够识别并处理这些文件
2. WHEN Markdown 文件包含元数据（如标题、日期、标签等）THEN 系统应当能够解析这些元数据用于页面生成
3. WHEN Markdown 文件使用标准语法（标题、列表、代码块、链接、图片等）THEN 系统应当正确转换为 HTML
4. WHEN `md/` 目录为空 THEN 系统应当提供示例文章模板或友好的提示信息

### 需求 3：主题系统

**用户故事：** 作为主题开发者，我希望有一个统一的主题结构规范，以便为 mblog 开发和分享自定义主题。

#### 验收标准

1. WHEN 系统初始化项目 THEN 应当在 `theme/` 目录中包含默认主题的所有必要文件
2. WHEN 主题包含模板文件 THEN 系统应当定义清晰的模板变量和结构规范
3. WHEN 主题包含 CSS/JavaScript 文件 THEN 系统应当能够正确引用和加载这些资源
4. WHEN 用户切换主题 THEN 系统应当能够通过配置文件指定不同的主题目录或主题名称
5. WHEN 社区开发者创建新主题 THEN 应当遵循统一的文件结构和接口规范

### 需求 4：静态页面生成

**用户故事：** 作为博客作者，我希望能够将 Markdown 文章转换为静态 HTML 页面，以便部署到任何静态网站托管服务。

#### 验收标准

1. WHEN 用户执行 `gen.py` 或相关生成命令 THEN 系统应当读取 `md/` 目录中的所有 Markdown 文件
2. WHEN 系统处理 Markdown 文件 THEN 应当将其转换为 HTML 并应用当前主题的样式
3. WHEN 生成完成 THEN 系统应当创建输出目录（如 `public/` 或 `dist/`）存储生成的静态文件
4. WHEN 生成静态页面 THEN 系统应当创建文章列表页、文章详情页以及其他必要的导航页面
5. WHEN 文章包含图片或其他资源 THEN 系统应当正确处理资源路径引用
6. IF 生成过程中出现错误 THEN 系统应当提供清晰的错误信息和文件位置

### 需求 5：配置管理

**用户故事：** 作为博客作者，我希望通过配置文件自定义博客的各项设置，以便个性化我的博客。

#### 验收标准

1. WHEN 项目初始化 THEN 系统应当生成包含默认配置的 `config.json` 文件
2. WHEN 配置文件存在 THEN 应当包含以下基本配置项：
   - 博客标题
   - 博客描述
   - 作者信息
   - 主题设置
   - 输出目录配置
3. WHEN 用户修改配置文件 THEN 生成程序应当读取并应用新的配置
4. WHEN 配置文件格式错误 THEN 系统应当提供清晰的错误提示
5. WHEN 不同主题需要不同配置项 THEN 配置文件应当支持主题特定的配置扩展

### 需求 6：GitHub Actions 自动部署

**用户故事：** 作为博客作者，我希望项目包含 GitHub Actions 配置，以便在推送代码后自动构建和部署博客。

#### 验收标准

1. WHEN 项目初始化 THEN 系统应当在 `.workflow/` 目录中生成 GitHub Actions 工作流配置文件
2. WHEN 工作流配置存在 THEN 应当包含以下步骤：
   - 检出代码
   - 设置 Python 环境
   - 安装依赖
   - 执行生成脚本
   - 部署到 GitHub Pages 或其他托管服务
3. WHEN 用户推送代码到 GitHub THEN 工作流应当自动触发并执行部署
4. WHEN 部署失败 THEN 工作流应当提供清晰的错误日志

### 需求 7：命令行界面

**用户故事：** 作为用户，我希望有一个友好的命令行界面，以便轻松使用 mblog 的各项功能。

#### 验收标准

1. WHEN 用户执行 `mblog` 不带参数 THEN 系统应当显示帮助信息和可用命令列表
2. WHEN 用户执行 `mblog --help` 或 `mblog -h` THEN 系统应当显示详细的使用说明
3. WHEN 用户执行 `mblog --version` 或 `mblog -v` THEN 系统应当显示当前版本号
4. WHEN 用户执行无效命令 THEN 系统应当提示错误并显示正确的命令格式
5. WHEN 命令执行成功 THEN 系统应当返回退出码 0
6. WHEN 命令执行失败 THEN 系统应当返回非零退出码
